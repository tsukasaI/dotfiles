# Claude Code PreToolUse blocklist
# Format: CATEGORY | command prefix | Block reason
#
# - Lines starting with # are comments. Blank lines are ignored.
# Pattern types:
#   prefix      → blocked at word boundary (e.g. "rm" blocks "rm foo" but not "remove-items")
#   prefix*     → starts-with match, no end boundary (e.g. "mkfs*" blocks "mkfs.ext4")
#   *keyword*   → contains anywhere in the command (e.g. "*secret*")
# To add a rule: add a line. To remove: delete or comment it out.

# ── Privilege escalation ──────────────────────────────────────────────────────
PRIVILEGE         | sudo              | sudo grants root-level access
PRIVILEGE         | su                | su switches to another user account
PRIVILEGE         | doas              | doas grants elevated privileges

# ── File destruction ──────────────────────────────────────────────────────────
FILE_DESTRUCTION  | rm                | rm permanently deletes files
FILE_DESTRUCTION  | shred             | shred securely wipes file data
FILE_DESTRUCTION  | truncate          | truncate zeroes out file contents

# ── Disk operations ───────────────────────────────────────────────────────────
DISK_OPERATION    | dd                | dd can overwrite raw disk blocks
DISK_OPERATION    | mkfs*             | mkfs / mkfs.ext4 etc. creates a new filesystem, destroying data
DISK_OPERATION    | fdisk             | fdisk edits partition tables
DISK_OPERATION    | gdisk             | gdisk edits partition tables
DISK_OPERATION    | parted            | parted edits partition tables
DISK_OPERATION    | diskutil erase    | diskutil erase permanently destroys disk data

# ── Network exfiltration ──────────────────────────────────────────────────────
NETWORK           | nc                | netcat opens raw TCP/UDP connections
NETWORK           | netcat            | netcat opens raw TCP/UDP connections
NETWORK           | wget              | wget can download or exfiltrate data to/from external hosts
# Note: curl is handled separately in the script (localhost is allowed)

# ── Process / service manipulation ───────────────────────────────────────────
PROCESS           | kill              | kill terminates system or user processes
PROCESS           | pkill             | pkill terminates processes by name
PROCESS           | killall           | killall terminates all matching processes
SERVICE           | launchctl load    | launchctl can load/alter macOS system services
SERVICE           | launchctl unload  | launchctl can unload macOS system services
SERVICE           | systemctl enable  | systemctl can alter Linux system services
SERVICE           | systemctl start   | systemctl can start Linux system services
SERVICE           | systemctl stop    | systemctl can stop Linux system services
SERVICE           | systemctl disable | systemctl can disable Linux system services

# ── Credential and secret file access ────────────────────────────────────────
# Prefix *...*  means "contains anywhere in the command" (not just at the start)
CREDENTIAL        | *secret*          | Command references something named 'secret'
CREDENTIAL        | *credential*      | Command references something named 'credential'
CREDENTIAL        | cat .env          | .env files may contain secrets
CREDENTIAL        | cat id_rsa        | SSH private key file
CREDENTIAL        | cat id_ed25519    | SSH private key file

# ── Environment variable exfiltration ────────────────────────────────────────
ENV_EXFIL         | printenv          | printenv dumps env vars that may include secrets
ENV_EXFIL         | env               | env dumps or manipulates environment variables
ENV_EXFIL         | export            | export reveals all exported environment variables
ENV_EXFIL         | set               | set (standalone) dumps all shell variables and functions

# ── Shell escape / code injection ─────────────────────────────────────────────
CODE_INJECTION    | eval              | eval executes arbitrary strings as shell code

# ── Permission / user modification ────────────────────────────────────────────
PERMISSION        | chmod             | chmod changes file permissions
PERMISSION        | chown             | chown changes file ownership
USER              | passwd            | passwd changes user account passwords
USER              | useradd           | useradd creates user accounts
USER              | userdel           | userdel deletes user accounts

# ── Git destructive operations ────────────────────────────────────────────────
GIT               | git add           | git add stages changes without explicit approval
GIT               | git commit        | git commit creates commits without explicit approval
GIT               | git push          | git push uploads changes to a remote repository
GIT               | git reset         | git reset rewrites history or discards changes
GIT               | git restore       | git restore discards uncommitted working tree changes
GIT               | git rebase        | git rebase rewrites commit history
GIT               | git rm            | git rm removes tracked files
GIT               | git tag           | git tag creates or deletes tags
GIT               | git branch -d     | git branch -d deletes a branch
GIT               | git branch -D     | git branch -D force-deletes a branch

# ── GitHub CLI destructive operations ─────────────────────────────────────────
GITHUB            | gh pr create      | gh pr create makes an irreversible remote PR
GITHUB            | gh pr comment     | gh pr comment posts to a remote PR
GITHUB            | gh pr edit        | gh pr edit modifies a remote PR
GITHUB            | gh pr close       | gh pr close closes a remote PR
GITHUB            | gh pr merge       | gh pr merge merges a remote PR
GITHUB            | gh issue create   | gh issue create posts a remote issue
GITHUB            | gh issue close    | gh issue close closes a remote issue
GITHUB            | gh release create | gh release create publishes a release

# ── History manipulation ──────────────────────────────────────────────────────
HISTORY           | history -c        | history -c clears shell command history
HISTORY           | history -d        | history -d deletes a history entry

# ── Cron / scheduling ────────────────────────────────────────────────────────
SCHEDULING        | crontab -e        | crontab -e edits the user crontab
SCHEDULING        | crontab -r        | crontab -r removes the user crontab

# ── SSH tunneling ─────────────────────────────────────────────────────────────
SSH               | ssh -L            | ssh -L opens a local port-forwarding tunnel
SSH               | ssh -R            | ssh -R opens a remote port-forwarding tunnel
SSH               | ssh -D            | ssh -D opens a SOCKS proxy tunnel
